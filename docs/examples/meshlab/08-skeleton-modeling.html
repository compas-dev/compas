
<!DOCTYPE html>

<html lang="en">
<head>
<title>compas -- a computational framework for research in architecture and structures</title>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<meta content="Tom Van Mele" name="author"/>
<meta content="compas is a computational framework for research in architecture and structures." name="description"/>
<link crossorigin="anonymous" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" rel="stylesheet"/>
<link href="/css/github.css" rel="stylesheet" type="text/css"/>
<link href="/css/compas.css" rel="stylesheet" type="text/css"/>
<link href="/css/compas-reference.css" rel="stylesheet" type="text/css"/>
<link href="10-stanford-bunny.html" rel="next" title="The Stanford Bunny"/>
<link href="07-subd-modeling.html" rel="prev" title="Subd mesh modeling"/>
<script async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
</head>
<body data-spy="scroll" data-target="#compas-localnav">
<header class="navbar navbar-expand navbar-dark bg-dark compas-navbar">
<a class="navbar-brand" href="/">compas</a>
<ul class="navbar-nav">
<li class="nav-item">
<a class="nav-link active" href="/compas">Main library</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/packages">Additional Packages</a>
</li>
</ul>
</header>
<div class="container-fluid compas-container">
<div class="row flex-xl-nowrap">
<main class="col-12 col-md-9 col-xl-8 compas-content" role="main">
<nav class="breadcrumb">
<a class="breadcrumb-item" href="https://compas-dev.github.io/">compas</a>
<a class="breadcrumb-item" href="https://compas-dev.github.io/compas/index.html">main library</a>
<a class="breadcrumb-item" href="../../examples.html">examples</a>
<a accesskey="U" class="breadcrumb-item" href="../meshlab.html">meshlab</a>
</nav>
<div class="section">
<span id="example-mesh-skeleton-modeling"></span><h1>Skeleton mesh modeling</h1>
<figure class="figure">
<img alt="../../images/example-mesh-skeleton-modeling.gif" class="figure-img img-fluid" src="../../images/example-mesh-skeleton-modeling.gif"/>
</figure>
<div class="card bg-light">
<div class="card-body">
<div class="card-title">Downloads</div><ul class="simple">
<li><code class="xref download docutils literal">example-mesh-skeleton-modeling.3dm</code></li>
<li><a class="reference download internal" download="" href="../../downloads/mesh-subd-modeling.py"><code class="xref download docutils literal">mesh-skeleton-modeling.py</code></a></li>
</ul>
</div>
</div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The simple implementation shown does not include angle checks between edges
meeting in one node. Hence, depending on the diameter of the cross section of
the “tubes”, the location of the “inner cross sections” and the angles, the
code might produce incompatible convex hull geometries and therefore
degenerate subdivision meshes.</p>
</div>
<div class="highlight"><pre><code class="language-python border rounded"><span></span><span class="sd">"""Mesh 08: Subd modeling</span>

<span class="sd">The following code computes a solidified smooth mesh from a spatial network of lines.</span>
<span class="sd">The shown method yields similar results as the exoskeleton plugin for Grasshopper</span>
<span class="sd">to create meshes for 3D printing.</span>

<span class="sd">"""</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">compas_rhino</span>

<span class="kn">from</span> <span class="nn">compas.datastructures.mesh</span> <span class="k">import</span> <span class="n">Mesh</span>
<span class="kn">from</span> <span class="nn">compas.geometry.elements.polyhedron</span> <span class="k">import</span> <span class="n">Polyhedron</span>
<span class="kn">from</span> <span class="nn">compas.datastructures.mesh.algorithms</span> <span class="k">import</span> <span class="n">subdivide_mesh_catmullclark</span>


<span class="n">__author__</span>    <span class="o">=</span> <span class="p">[</span><span class="s1">'Tom Van Mele'</span><span class="p">,</span> <span class="p">]</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s1">'Copyright 2017, BRG - ETH Zurich'</span><span class="p">,</span>
<span class="n">__license__</span>   <span class="o">=</span> <span class="s1">'MIT'</span>
<span class="n">__email__</span>     <span class="o">=</span> <span class="s1">'van.mele@arch.ethz.ch'</span>


<span class="c1"># clear the *SubdModeling* layer</span>

<span class="n">compas_rhino</span><span class="o">.</span><span class="n">clear_layer</span><span class="p">(</span><span class="s1">'SubdModeling'</span><span class="p">)</span>

<span class="c1"># make a control mesh</span>

<span class="n">cube</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">from_vertices_and_faces</span><span class="p">(</span><span class="n">cube</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">cube</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>

<span class="c1"># give it a name</span>
<span class="c1"># and set default vertex attributes</span>

<span class="n">mesh</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Control'</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">update_default_vertex_attributes</span><span class="p">({</span><span class="s1">'is_fixed'</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

<span class="c1"># draw the control mesh</span>
<span class="c1"># with showing the faces</span>

<span class="n">compas_rhino</span><span class="o">.</span><span class="n">draw_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span>
                       <span class="n">layer</span><span class="o">=</span><span class="s1">'SubdModeling::Control'</span><span class="p">,</span>
                       <span class="n">clear_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">show_faces</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">show_vertices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">show_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># allow the user to change the attributes of the vertices</span>
<span class="c1"># note: the interaction loop exits</span>
<span class="c1">#       when the user cancels the selection of mesh vertices</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">compas_rhino</span><span class="o">.</span><span class="n">select_mesh_vertices</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">keys</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="n">compas_rhino</span><span class="o">.</span><span class="n">update_mesh_vertex_attributes</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>

<span class="c1"># redraw the mesh to reflect the changes by the user</span>

<span class="n">compas_rhino</span><span class="o">.</span><span class="n">draw_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span>
                       <span class="n">layer</span><span class="o">=</span><span class="s1">'SubdModeling::Control'</span><span class="p">,</span>
                       <span class="n">clear_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">show_faces</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">show_vertices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">show_edges</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">vertexcolor</span><span class="o">=</span><span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="s1">'#ff0000'</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices_where</span><span class="p">({</span><span class="s1">'is_fixed'</span><span class="p">:</span> <span class="kc">True</span><span class="p">})})</span>

<span class="c1"># make a subd mesh (using catmullclark)</span>
<span class="c1"># keep the vertices fixed</span>
<span class="c1"># as indicated by the user</span>

<span class="n">fixed</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">vertices_where</span><span class="p">({</span><span class="s1">'is_fixed'</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">subd</span> <span class="o">=</span> <span class="n">subdivide_mesh_catmullclark</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="n">fixed</span><span class="p">)</span>

<span class="c1"># give the mesh a (different) name</span>

<span class="n">subd</span><span class="o">.</span><span class="n">attributes</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Mesh'</span>

<span class="c1"># draw the result</span>

<span class="n">compas_rhino</span><span class="o">.</span><span class="n">draw_mesh</span><span class="p">(</span><span class="n">subd</span><span class="p">,</span>
                       <span class="n">layer</span><span class="o">=</span><span class="s1">'SubdModeling::Mesh'</span><span class="p">,</span>
                       <span class="n">clear_layer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">show_faces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">show_vertices</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">show_edges</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

</div>
<nav class="compas-sideways">
<a class="btn btn-primary compas-prev" href="07-subd-modeling.html" role="button">Subd mesh modeling</a>
<a class="btn btn-primary compas-next" href="10-stanford-bunny.html" role="button">The Stanford Bunny</a>
</nav>
</main>
<div class="col-12 col-md-3 col-xl-2 compas-sidebar" role="navigation">
<div class="navbar-light">
<form action="../../search.html" class="d-flex compas-searchbox" id="" method="get">
<input class="form-control" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
<button aria-controls="compas-navigation" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler d-md-none compas-navigation-toggler" data-target="#compas-navigation" data-toggle="collapse" type="button">
<span class="navbar-toggler-icon"></span>
</button>
</form>
<div class="navbar-expand-md">
<div class="collapse navbar-collapse compas-navigation" id="compas-navigation">
<ul class="nav flex-column active">
<li class="nav-item"><a class="nav-link reference internal" href="../../overview.html">Overview</a></li>
<li class="nav-item active"><a class="nav-link reference internal" href="../../examples.html">Examples</a><ul class="nav active">
<li class="nav-item"><a class="nav-link reference internal" href="../formfinding.html">Form Finding</a></li>
<li class="nav-item active"><a class="nav-link reference internal" href="../meshlab.html">MeshLab</a><ul class="nav active">
<li class="nav-item"><a class="nav-link reference internal" href="0001-delaunay.html">Delaunay triangulation</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="0002-delaunay-with-boundary.html">Delaunay triangulation with boundary</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="0010-smoothing.html">Mesh smoothing</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="0011-smoothing-with-conduit.html">Visualising mesh smoothing with a conduit</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="0012-smoothing-on-surface.html">Mesh smoothing on a surface</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="0013-planarisation.html">Mesh planarisation</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="05-collapse.html">Collapse mesh to a single vertex</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="05-remeshing.html">Remeshing 2D</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="06-remeshing-on-mesh.html">Remeshing 3D</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="07-subd-modeling.html">Subd mesh modeling</a></li>
<li class="nav-item active"><a class="nav-link active current reference internal" href="#">Skeleton mesh modeling</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="10-stanford-bunny.html">The Stanford Bunny</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="11-stanford-dragon.html">The Stanford Dragon</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="12-stanford-armadillo.html">The Stanford Armadillo</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="13-parameterisation.html">Mesh parametrisation</a></li>
</ul>
</li>
<li class="nav-item"><a class="nav-link reference internal" href="../networktopology.html">Network Topology</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="../misc.html">Miscellaneous</a></li>
</ul>
</li>
<li class="nav-item"><a class="nav-link reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="../../reference.html">Reference</a></li>
<li class="nav-item"><a class="nav-link reference internal" href="../../notes.html">Notes</a></li>
</ul>
</div>
</div>
</div>
</div>
<div class="d-none d-xl-block col-xl-2 compas-toc" role="toc">
<ul class="nav flex-column" id="compas-localnav">
<li class="nav-item"><a class="nav-link reference internal" href="#">Skeleton mesh modeling</a></li>
</ul>
</div>
</div>
</div>
<footer class="compas-footer">
            
                
                    © Copyright 2017, Block Research Group - ETH Zurich.
                
            

            
                Last updated on Oct 22, 2017.
            

            
                Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
            
        </footer>
<script type="text/javascript">
var DOCUMENTATION_OPTIONS = {
    URL_ROOT:    '',
    VERSION:     '',
    COLLAPSE_INDEX: false,
    FILE_SUFFIX: '.html',
    HAS_SOURCE:  true,
    SOURCELINK_SUFFIX: '.txt'
};
            </script>
<script crossorigin="anonymous" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.0.0/anchor.js"></script>
<script src="/static/underscore.js"></script>
<script src="/static/doctools.js"></script>
<script src="https://compas-dev.github.io/compas/static/searchtools_.js"></script>
<script>
                hljs.initHighlightingOnLoad();
                anchors.add();
            </script>
</body>
</html>